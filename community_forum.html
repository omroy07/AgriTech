<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Community Hub | AgriTech Forum</title>

  <!-- Icons & Fonts -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

  <!-- Custom Theme -->
  <link rel="stylesheet" href="forum.css">
</head>

<body>

  <!-- AgriTech Navbar -->
  <nav class="navbar">
    <div class="navbar-content">
      <div class="navbar-left">
        <a href="index.html" class="navbar-brand">
          <img src="images/logo.png" alt="AgriTech">
          AgriTech
        </a>

        <div class="nav-links">
          <a href="index.html">Home</a>
          <a href="about.html">About</a>
          <a href="blog.html">Blog</a>
          <a href="scheme.html">Schemes</a>
          <a href="community_forum.html">Community Forum</a>
        </div>
      </div>

      <div class="navbar-right">
        <div class="nav-search">
          <input type="text" placeholder="Search...">
          <button><i class="fas fa-search"></i></button>
        </div>

        <button class="nav-btn">English</button>
        <button class="nav-btn theme-toggle">ðŸŒ™ Dark Mode</button>
        <a href="login.html" class="nav-btn">Login</a>
        <a href="register.html" class="nav-btn primary">Register</a>
      </div>
    </div>
  </nav>

  <div class="forum-layout">

    <!-- Left Sidebar: Navigation & Filters -->
    <aside class="sidebar">
      <div class="card">
        <h3><i class="fas fa-compass"></i> Discover</h3>
        <div id="categories-list">
          <div class="loader">Fetching categories...</div>
        </div>
      </div>

      <div class="card">
        <h3><i class="fas fa-trophy"></i> My Reputation</h3>
        <div class="user-rep-panel">
          <div class="score-display">
            <span id="user-score">--</span>
            <small>Total Points</small>
          </div>
          <div id="user-badge" class="badge-status">
            Loading...
          </div>
        </div>
      </div>
    </aside>

    <!-- Main Feed: Discussions -->
    <main class="feed">
      <header class="feed-header">
        <div class="search-container">
          <i class="fas fa-search"></i>
          <input type="text" id="forum-search" class="search-input"
            placeholder="Search for experts, topics, or solutions...">
        </div>
        <button class="btn-ask" id="btn-new-thread">
          <i class="fas fa-plus"></i> New Topic
        </button>
      </header>

      <div id="threads-feed">
        <!-- Threads will be injected here -->
      </div>
    </main>

    <!-- Right Widgets: Trends & AI -->
    <aside class="widgets">
      <div class="card">
        <h3><i class="fas fa-robot"></i> AgriAI Insights</h3>
        <p style="font-size: 0.9rem; color: var(--text-muted); margin-bottom: 1rem;">
          AI is currently monitoring the forum for spam and helpful opportunities.
        </p>
        <div class="ai-status">
          <span class="ai-badge">Active</span>
          <small>Moderating Content</small>
        </div>
      </div>

      <div class="card">
        <h3><i class="fas fa-fire"></i> Trending Topics</h3>
        <div id="trending-list">
          <p style="font-size: 0.85rem; color: var(--text-muted);">Real-time trends appearing soon...</p>
        </div>
      </div>
    </aside>
  </div>

  <!-- Create Thread Modal -->
  <div class="modal-overlay" id="create-thread-modal">
    <div class="card modal-content">
      <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem;">
        <h2 style="font-size: 1.5rem;">Start a Conversation</h2>
        <button onclick="forum.toggleModal('create-thread-modal', false)"
          style="background: none; border: none; cursor: pointer; font-size: 1.2rem; color: var(--text-muted);">
          <i class="fas fa-times"></i>
        </button>
      </div>

      <div class="form-group" style="margin-bottom: 1.25rem;">
        <label style="display: block; margin-bottom: 0.5rem; font-weight: 500;">Discussion Category</label>
        <select id="thread-category-select" class="search-input" style="padding-left: 1rem; width: 100%;">
          <option value="1">General Farming</option>
          <option value="2">Crop Protection</option>
          <option value="3">Soil Health</option>
          <option value="4">Equipment Advice</option>
        </select>
      </div>

      <div class="form-group" style="margin-bottom: 1.25rem;">
        <label style="display: block; margin-bottom: 0.5rem; font-weight: 500;">Topic Title</label>
        <input type="text" id="thread-title-input" class="search-input" style="padding-left: 1rem;"
          placeholder="e.g. Best organic fertilizer for Wheat?">
      </div>

      <div class="form-group" style="margin-bottom: 1.5rem;">
        <label style="display: block; margin-bottom: 0.5rem; font-weight: 500;">Content Details</label>
        <textarea id="thread-content-input" class="search-input"
          style="padding-left: 1rem; min-height: 150px; resize: vertical;"
          placeholder="Describe your question or share your knowledge here..."></textarea>
      </div>

      <div style="display: flex; justify-content: flex-end; gap: 1rem;">
        <button onclick="forum.toggleModal('create-thread-modal', false)" class="btn-ask"
          style="background: var(--bg-main); color: var(--text-main);">Cancel</button>
        <button onclick="forum.createThread()" class="btn-ask">Post Discussion</button>
      </div>
    </div>
  </div>

  <!-- Scripts -->
  <script src="forum.js"></script>

  <!-- ===== Universal Back To Top Button (All Pages) ===== -->
<style>
  #globalBackToTop {
    position: fixed;
    bottom: 90px; /* prevents overlap with chatbot/floating icons */
    right: 25px;
    z-index: 9999;
    display: none;
    background: #2ecc71;
    color: #ffffff;
    border: none;
    border-radius: 50%;
    width: 52px;
    height: 52px;
    font-size: 22px;
    font-weight: bold;
    cursor: pointer;
    box-shadow: 0 6px 16px rgba(0,0,0,0.25);
    transition: opacity 0.3s ease, transform 0.2s ease;
  }

  #globalBackToTop:hover {
    transform: scale(1.12);
    background: #27ae60;
  }

  @media (max-width: 768px) {
    #globalBackToTop {
      bottom: 100px; /* better spacing on mobile */
      right: 18px;
      width: 48px;
      height: 48px;
      font-size: 20px;
    }
  }
</style>

<button id="globalBackToTop" title="Back to Top">â†‘</button>

<script>
  (function () {
    const btn = document.getElementById("globalBackToTop");

    // Show button after scrolling down
    window.addEventListener("scroll", function () {
      if (window.scrollY > 300) {
        btn.style.display = "block";
      } else {
        btn.style.display = "none";
      }
    });

    // Smooth scroll to top on click
    btn.addEventListener("click", function () {
      window.scrollTo({
        top: 0,
        behavior: "smooth"
      });
    });
  })();
</script>
<!-- ===== End Back To Top Button ===== -->

</body>

</html>